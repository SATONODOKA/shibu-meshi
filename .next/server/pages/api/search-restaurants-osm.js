"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/search-restaurants-osm";
exports.ids = ["pages/api/search-restaurants-osm"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsearch-restaurants-osm&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsearch-restaurants-osm.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsearch-restaurants-osm&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsearch-restaurants-osm.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_search_restaurants_osm_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/search-restaurants-osm.ts */ \"(api)/./pages/api/search-restaurants-osm.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_search_restaurants_osm_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_search_restaurants_osm_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_search_restaurants_osm_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_search_restaurants_osm_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/search-restaurants-osm\",\n        pathname: \"/api/search-restaurants-osm\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_search_restaurants_osm_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnNlYXJjaC1yZXN0YXVyYW50cy1vc20mcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyUyRmFwaSUyRnNlYXJjaC1yZXN0YXVyYW50cy1vc20udHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDa0U7QUFDbEU7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLGlFQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxpRUFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaGlidS1tZXNoaS8/OGU3ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL3NlYXJjaC1yZXN0YXVyYW50cy1vc20udHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9zZWFyY2gtcmVzdGF1cmFudHMtb3NtXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc2VhcmNoLXJlc3RhdXJhbnRzLW9zbVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsearch-restaurants-osm&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsearch-restaurants-osm.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/overpass.ts":
/*!*************************!*\
  !*** ./lib/overpass.ts ***!
  \*************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CUISINE_MAPPING: () => (/* binding */ CUISINE_MAPPING),\n/* harmony export */   buildRestaurantQuery: () => (/* binding */ buildRestaurantQuery),\n/* harmony export */   calculateDistance: () => (/* binding */ calculateDistance),\n/* harmony export */   geocodeAddress: () => (/* binding */ geocodeAddress),\n/* harmony export */   parseOSMRestaurant: () => (/* binding */ parseOSMRestaurant),\n/* harmony export */   queryOverpass: () => (/* binding */ queryOverpass),\n/* harmony export */   scoreRestaurant: () => (/* binding */ scoreRestaurant),\n/* harmony export */   searchRestaurants: () => (/* binding */ searchRestaurants)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"axios\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_0__]);\naxios__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// OpenStreetMap Overpass API クライアント\n\n// Overpass APIエンドポイント（複数のサーバーを設定）\nconst OVERPASS_ENDPOINTS = [\n    \"https://overpass-api.de/api/interpreter\",\n    \"https://overpass.private.coffee/api/interpreter\",\n    \"https://overpass.openstreetmap.ru/api/interpreter\"\n];\n// Overpass API クライアント（複数エンドポイント対応）\nasync function queryOverpass(query) {\n    let lastError = null;\n    for (const endpoint of OVERPASS_ENDPOINTS){\n        try {\n            const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].post(endpoint, `data=${encodeURIComponent(query)}`, {\n                headers: {\n                    \"Content-Type\": \"application/x-www-form-urlencoded\"\n                },\n                timeout: 15000\n            });\n            return response.data;\n        } catch (error) {\n            console.warn(`Overpass endpoint ${endpoint} failed:`, error);\n            lastError = error;\n            continue;\n        }\n    }\n    throw lastError || new Error(\"すべてのOverpass APIエンドポイントが利用できません\");\n}\n// 飲食店検索クエリ生成\nfunction buildRestaurantQuery(params) {\n    const { lat, lon, radius = 2000, cuisineTypes = [] } = params;\n    // 検索範囲を計算（緯度経度の概算）\n    const latDiff = radius / 111000; // 緯度1度 ≈ 111km\n    const lonDiff = radius / (111000 * Math.cos(lat * Math.PI / 180));\n    const south = lat - latDiff;\n    const north = lat + latDiff;\n    const west = lon - lonDiff;\n    const east = lon + lonDiff;\n    // 料理タイプフィルター\n    let cuisineFilter = \"\";\n    if (cuisineTypes.length > 0) {\n        const cuisineRegex = cuisineTypes.map((type)=>type.toLowerCase()).join(\"|\");\n        cuisineFilter = `[cuisine~\"${cuisineRegex}\",i]`;\n    }\n    // Overpass QL クエリ\n    const query = `\n    [out:json][timeout:25];\n    (\n      // レストラン・カフェ・ファストフード\n      node[\"amenity\"~\"^(restaurant|cafe|fast_food|bar|pub|izakaya)$\"]${cuisineFilter}(${south},${west},${north},${east});\n      way[\"amenity\"~\"^(restaurant|cafe|fast_food|bar|pub|izakaya)$\"]${cuisineFilter}(${south},${west},${north},${east});\n      relation[\"amenity\"~\"^(restaurant|cafe|fast_food|bar|pub|izakaya)$\"]${cuisineFilter}(${south},${west},${north},${east});\n      \n      // 日本特有の飲食タグ\n      node[\"cuisine\"]${cuisineFilter}(${south},${west},${north},${east});\n      way[\"cuisine\"]${cuisineFilter}(${south},${west},${north},${east});\n      \n      // 居酒屋特別対応\n      node[\"amenity\"=\"izakaya\"](${south},${west},${north},${east});\n      way[\"amenity\"=\"izakaya\"](${south},${west},${north},${east});\n    );\n    out center meta;\n  `;\n    return query.trim();\n}\n// 料理タイプマッピング（日本語→英語/OSMタグ）\nconst CUISINE_MAPPING = {\n    \"和食\": [\n        \"japanese\",\n        \"sushi\",\n        \"ramen\",\n        \"udon\",\n        \"soba\",\n        \"tempura\",\n        \"yakitori\"\n    ],\n    \"中華\": [\n        \"chinese\",\n        \"asian\"\n    ],\n    \"イタリアン\": [\n        \"italian\",\n        \"pizza\",\n        \"pasta\"\n    ],\n    \"フレンチ\": [\n        \"french\"\n    ],\n    \"韓国料理\": [\n        \"korean\",\n        \"asian\"\n    ],\n    \"タイ料理\": [\n        \"thai\",\n        \"asian\"\n    ],\n    \"インド料理\": [\n        \"indian\"\n    ],\n    \"アメリカン\": [\n        \"american\",\n        \"burger\"\n    ],\n    \"焼肉\": [\n        \"bbq\",\n        \"korean\",\n        \"yakiniku\"\n    ],\n    \"居酒屋\": [\n        \"izakaya\",\n        \"japanese\"\n    ],\n    \"カフェ\": [\n        \"cafe\",\n        \"coffee\"\n    ],\n    \"ファストフード\": [\n        \"fast_food\",\n        \"burger\"\n    ],\n    \"洋食\": [\n        \"western\",\n        \"european\"\n    ],\n    \"アジア料理\": [\n        \"asian\",\n        \"thai\",\n        \"vietnamese\",\n        \"korean\"\n    ],\n    \"バー\": [\n        \"bar\",\n        \"cocktail\"\n    ],\n    \"寿司\": [\n        \"sushi\",\n        \"japanese\"\n    ],\n    \"ラーメン\": [\n        \"ramen\",\n        \"japanese\"\n    ],\n    \"焼き鳥\": [\n        \"yakitori\",\n        \"japanese\"\n    ],\n    \"天ぷら\": [\n        \"tempura\",\n        \"japanese\"\n    ],\n    \"うどん\": [\n        \"udon\",\n        \"japanese\"\n    ],\n    \"そば\": [\n        \"soba\",\n        \"japanese\"\n    ]\n};\n// 距離計算（ハバサイン公式）\nfunction calculateDistance(lat1, lon1, lat2, lon2) {\n    const R = 6371000; // 地球の半径（メートル）\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLon = (lon2 - lon1) * Math.PI / 180;\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n}\n// OSMデータからレストラン情報を抽出\nfunction parseOSMRestaurant(element, userLat, userLon) {\n    const lat = element.lat || (element.center ? element.center.lat : 0);\n    const lon = element.lon || (element.center ? element.center.lon : 0);\n    const name = element.tags?.name || element.tags?.[\"name:ja\"] || \"unknown\";\n    const distance = calculateDistance(userLat, userLon, lat, lon);\n    return {\n        id: `${element.type}_${element.id}`,\n        name,\n        cuisine: element.tags?.cuisine,\n        amenity: element.tags?.amenity,\n        lat,\n        lon,\n        tags: element.tags || {},\n        distance: Math.round(distance)\n    };\n}\n// 気分に基づくスコアリング\nfunction scoreRestaurant(restaurant, moodAnalysis) {\n    let score = 100; // ベーススコア\n    // 距離による減点（近いほど高得点）\n    if (restaurant.distance) {\n        score -= Math.min(restaurant.distance / 50, 50); // 最大50点減点\n    }\n    // 料理タイプマッチング\n    if (moodAnalysis.cuisine_types && restaurant.cuisine) {\n        const matchedCuisines = moodAnalysis.cuisine_types.some((type)=>CUISINE_MAPPING[type]?.some((mappedType)=>restaurant.cuisine?.toLowerCase().includes(mappedType) || restaurant.tags?.cuisine?.toLowerCase().includes(mappedType)));\n        if (matchedCuisines) score += 30;\n    }\n    // 雰囲気マッチング（タグベース）\n    if (moodAnalysis.atmosphere) {\n        const atmosphere = moodAnalysis.atmosphere.toLowerCase();\n        if (atmosphere.includes(\"リラックス\") && (restaurant.amenity === \"cafe\" || restaurant.tags?.atmosphere === \"casual\")) {\n            score += 20;\n        }\n        if (atmosphere.includes(\"特別\") && restaurant.tags?.formal === \"yes\") {\n            score += 25;\n        }\n        if (atmosphere.includes(\"にぎやか\") && restaurant.amenity === \"izakaya\") {\n            score += 20;\n        }\n    }\n    // 価格帯マッチング\n    if (moodAnalysis.price_range && restaurant.tags?.price_range) {\n        const priceMap = {\n            \"安い\": [\n                \"$\",\n                \"budget\",\n                \"cheap\"\n            ],\n            \"普通\": [\n                \"$$\",\n                \"moderate\"\n            ],\n            \"高い\": [\n                \"$$$\",\n                \"$$$$\",\n                \"expensive\",\n                \"fine_dining\"\n            ]\n        };\n        const expectedPrices = priceMap[moodAnalysis.price_range] || [];\n        if (expectedPrices.some((price)=>restaurant.tags?.price_range?.includes(price))) {\n            score += 15;\n        }\n    }\n    return Math.max(0, Math.min(100, score));\n}\n// メイン検索関数\nasync function searchRestaurants(params, moodAnalysis) {\n    try {\n        console.log(\"Search params:\", params);\n        // 料理タイプを英語/OSMタグに変換\n        const cuisineTypes = params.cuisineTypes?.flatMap((type)=>CUISINE_MAPPING[type] || []) || [];\n        const searchParams = {\n            ...params,\n            cuisineTypes\n        };\n        console.log(\"Mapped cuisine types:\", cuisineTypes);\n        // Overpass クエリ実行\n        const query = buildRestaurantQuery(searchParams);\n        console.log(\"Overpass query:\", query.substring(0, 200) + \"...\");\n        const data = await queryOverpass(query);\n        console.log(\"Overpass response elements count:\", data.elements?.length || 0);\n        if (!data.elements || data.elements.length === 0) {\n            return [];\n        }\n        // 結果を解析\n        const restaurants = data.elements.filter((element)=>element.tags?.name) // 名前があるもののみ\n        .map((element)=>parseOSMRestaurant(element, params.lat, params.lon)).filter((restaurant)=>restaurant.distance && restaurant.distance <= (params.radius || 2000));\n        // 気分分析に基づくスコアリング\n        if (moodAnalysis) {\n            restaurants.forEach((restaurant)=>{\n                restaurant.score = scoreRestaurant(restaurant, moodAnalysis);\n            });\n            // スコア順にソート\n            restaurants.sort((a, b)=>(b.score || 0) - (a.score || 0));\n        } else {\n            // 距離順にソート\n            restaurants.sort((a, b)=>(a.distance || 0) - (b.distance || 0));\n        }\n        return restaurants.slice(0, 20); // 上位20件\n    } catch (error) {\n        console.error(\"Restaurant search error:\", error);\n        throw new Error(\"レストラン検索に失敗しました。ネットワーク接続を確認してください。\");\n    }\n}\n// 住所から座標を取得（Nominatim API）\nasync function geocodeAddress(address) {\n    try {\n        const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(\"https://nominatim.openstreetmap.org/search\", {\n            params: {\n                q: address,\n                format: \"json\",\n                limit: 1,\n                countrycodes: \"jp\"\n            },\n            headers: {\n                \"User-Agent\": \"ShibuMeshi/1.0 (https://github.com/your-repo)\"\n            }\n        });\n        if (response.data && response.data.length > 0) {\n            const result = response.data[0];\n            return {\n                lat: parseFloat(result.lat),\n                lon: parseFloat(result.lon)\n            };\n        }\n        return null;\n    } catch (error) {\n        console.error(\"Geocoding error:\", error);\n        return null;\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bEYsR0FBRztZQUM1QjtRQUNGO1FBRUEsT0FBTztJQUNULEVBQUUsT0FBT1AsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsb0JBQW9CQTtRQUNsQyxPQUFPO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NoaWJ1LW1lc2hpLy4vbGliL292ZXJwYXNzLnRzP2UyOWIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gT3BlblN0cmVldE1hcCBPdmVycGFzcyBBUEkg44Kv44Op44Kk44Ki44Oz44OIXG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xuXG4vLyBPdmVycGFzcyBBUEnjgqjjg7Pjg4njg53jgqTjg7Pjg4jvvIjopIfmlbDjga7jgrXjg7zjg5Djg7zjgpLoqK3lrprvvIlcbmNvbnN0IE9WRVJQQVNTX0VORFBPSU5UUyA9IFtcbiAgJ2h0dHBzOi8vb3ZlcnBhc3MtYXBpLmRlL2FwaS9pbnRlcnByZXRlcicsXG4gICdodHRwczovL292ZXJwYXNzLnByaXZhdGUuY29mZmVlL2FwaS9pbnRlcnByZXRlcicsXG4gICdodHRwczovL292ZXJwYXNzLm9wZW5zdHJlZXRtYXAucnUvYXBpL2ludGVycHJldGVyJ1xuXTtcblxuZXhwb3J0IGludGVyZmFjZSBPU01SZXN0YXVyYW50IHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBjdWlzaW5lPzogc3RyaW5nO1xuICBhbWVuaXR5Pzogc3RyaW5nO1xuICBsYXQ6IG51bWJlcjtcbiAgbG9uOiBudW1iZXI7XG4gIHRhZ3M6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gIGRpc3RhbmNlPzogbnVtYmVyO1xuICBzY29yZT86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hQYXJhbXMge1xuICBsYXQ6IG51bWJlcjtcbiAgbG9uOiBudW1iZXI7XG4gIHJhZGl1cz86IG51bWJlcjsgLy8g44Oh44O844OI44Or5Y2Y5L2N44CB44OH44OV44Kp44Or44OIMjAwMG1cbiAgY3Vpc2luZVR5cGVzPzogc3RyaW5nW107XG4gIGF0bW9zcGhlcmU/OiBzdHJpbmc7XG4gIHByaWNlUmFuZ2U/OiBzdHJpbmc7XG59XG5cbi8vIE92ZXJwYXNzIEFQSSDjgq/jg6njgqTjgqLjg7Pjg4jvvIjopIfmlbDjgqjjg7Pjg4njg53jgqTjg7Pjg4jlr77lv5zvvIlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBxdWVyeU92ZXJwYXNzKHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsO1xuXG4gIGZvciAoY29uc3QgZW5kcG9pbnQgb2YgT1ZFUlBBU1NfRU5EUE9JTlRTKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MucG9zdChlbmRwb2ludCwgYGRhdGE9JHtlbmNvZGVVUklDb21wb25lbnQocXVlcnkpfWAsIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyxcbiAgICAgICAgfSxcbiAgICAgICAgdGltZW91dDogMTUwMDAsIC8vIDE156eS44K/44Kk44Og44Ki44Km44OIXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybihgT3ZlcnBhc3MgZW5kcG9pbnQgJHtlbmRwb2ludH0gZmFpbGVkOmAsIGVycm9yKTtcbiAgICAgIGxhc3RFcnJvciA9IGVycm9yIGFzIEVycm9yO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICB9XG5cbiAgdGhyb3cgbGFzdEVycm9yIHx8IG5ldyBFcnJvcign44GZ44G544Gm44GuT3ZlcnBhc3MgQVBJ44Ko44Oz44OJ44Od44Kk44Oz44OI44GM5Yip55So44Gn44GN44G+44Gb44KTJyk7XG59XG5cbi8vIOmjsumjn+W6l+aknOe0ouOCr+OCqOODqueUn+aIkFxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkUmVzdGF1cmFudFF1ZXJ5KHBhcmFtczogU2VhcmNoUGFyYW1zKTogc3RyaW5nIHtcbiAgY29uc3QgeyBsYXQsIGxvbiwgcmFkaXVzID0gMjAwMCwgY3Vpc2luZVR5cGVzID0gW10gfSA9IHBhcmFtcztcblxuICAvLyDmpJzntKLnr4Tlm7LjgpLoqIjnrpfvvIjnt6/luqbntYzluqbjga7mpoLnrpfvvIlcbiAgY29uc3QgbGF0RGlmZiA9IHJhZGl1cyAvIDExMTAwMDsgLy8g57ev5bqmMeW6piDiiYggMTExa21cbiAgY29uc3QgbG9uRGlmZiA9IHJhZGl1cyAvICgxMTEwMDAgKiBNYXRoLmNvcyhsYXQgKiBNYXRoLlBJIC8gMTgwKSk7XG5cbiAgY29uc3Qgc291dGggPSBsYXQgLSBsYXREaWZmO1xuICBjb25zdCBub3J0aCA9IGxhdCArIGxhdERpZmY7XG4gIGNvbnN0IHdlc3QgPSBsb24gLSBsb25EaWZmO1xuICBjb25zdCBlYXN0ID0gbG9uICsgbG9uRGlmZjtcblxuICAvLyDmlpnnkIbjgr/jgqTjg5fjg5XjgqPjg6vjgr/jg7xcbiAgbGV0IGN1aXNpbmVGaWx0ZXIgPSAnJztcbiAgaWYgKGN1aXNpbmVUeXBlcy5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgY3Vpc2luZVJlZ2V4ID0gY3Vpc2luZVR5cGVzXG4gICAgICAubWFwKHR5cGUgPT4gdHlwZS50b0xvd2VyQ2FzZSgpKVxuICAgICAgLmpvaW4oJ3wnKTtcbiAgICBjdWlzaW5lRmlsdGVyID0gYFtjdWlzaW5lflwiJHtjdWlzaW5lUmVnZXh9XCIsaV1gO1xuICB9XG5cbiAgLy8gT3ZlcnBhc3MgUUwg44Kv44Ko44OqXG4gIGNvbnN0IHF1ZXJ5ID0gYFxuICAgIFtvdXQ6anNvbl1bdGltZW91dDoyNV07XG4gICAgKFxuICAgICAgLy8g44Os44K544OI44Op44Oz44O744Kr44OV44Kn44O744OV44Kh44K544OI44OV44O844OJXG4gICAgICBub2RlW1wiYW1lbml0eVwiflwiXihyZXN0YXVyYW50fGNhZmV8ZmFzdF9mb29kfGJhcnxwdWJ8aXpha2F5YSkkXCJdJHtjdWlzaW5lRmlsdGVyfSgke3NvdXRofSwke3dlc3R9LCR7bm9ydGh9LCR7ZWFzdH0pO1xuICAgICAgd2F5W1wiYW1lbml0eVwiflwiXihyZXN0YXVyYW50fGNhZmV8ZmFzdF9mb29kfGJhcnxwdWJ8aXpha2F5YSkkXCJdJHtjdWlzaW5lRmlsdGVyfSgke3NvdXRofSwke3dlc3R9LCR7bm9ydGh9LCR7ZWFzdH0pO1xuICAgICAgcmVsYXRpb25bXCJhbWVuaXR5XCJ+XCJeKHJlc3RhdXJhbnR8Y2FmZXxmYXN0X2Zvb2R8YmFyfHB1YnxpemFrYXlhKSRcIl0ke2N1aXNpbmVGaWx0ZXJ9KCR7c291dGh9LCR7d2VzdH0sJHtub3J0aH0sJHtlYXN0fSk7XG4gICAgICBcbiAgICAgIC8vIOaXpeacrOeJueacieOBrumjsumjn+OCv+OCsFxuICAgICAgbm9kZVtcImN1aXNpbmVcIl0ke2N1aXNpbmVGaWx0ZXJ9KCR7c291dGh9LCR7d2VzdH0sJHtub3J0aH0sJHtlYXN0fSk7XG4gICAgICB3YXlbXCJjdWlzaW5lXCJdJHtjdWlzaW5lRmlsdGVyfSgke3NvdXRofSwke3dlc3R9LCR7bm9ydGh9LCR7ZWFzdH0pO1xuICAgICAgXG4gICAgICAvLyDlsYXphZLlsYvnibnliKXlr77lv5xcbiAgICAgIG5vZGVbXCJhbWVuaXR5XCI9XCJpemFrYXlhXCJdKCR7c291dGh9LCR7d2VzdH0sJHtub3J0aH0sJHtlYXN0fSk7XG4gICAgICB3YXlbXCJhbWVuaXR5XCI9XCJpemFrYXlhXCJdKCR7c291dGh9LCR7d2VzdH0sJHtub3J0aH0sJHtlYXN0fSk7XG4gICAgKTtcbiAgICBvdXQgY2VudGVyIG1ldGE7XG4gIGA7XG5cbiAgcmV0dXJuIHF1ZXJ5LnRyaW0oKTtcbn1cblxuLy8g5paZ55CG44K/44Kk44OX44Oe44OD44OU44Oz44Kw77yI5pel5pys6Kqe4oaS6Iux6KqeL09TTeOCv+OCsO+8iVxuZXhwb3J0IGNvbnN0IENVSVNJTkVfTUFQUElORzogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xuICAn5ZKM6aOfJzogWydqYXBhbmVzZScsICdzdXNoaScsICdyYW1lbicsICd1ZG9uJywgJ3NvYmEnLCAndGVtcHVyYScsICd5YWtpdG9yaSddLFxuICAn5Lit6I+vJzogWydjaGluZXNlJywgJ2FzaWFuJ10sXG4gICfjgqTjgr/jg6rjgqLjg7MnOiBbJ2l0YWxpYW4nLCAncGl6emEnLCAncGFzdGEnXSxcbiAgJ+ODleODrOODs+ODgSc6IFsnZnJlbmNoJ10sXG4gICfpn5Plm73mlpnnkIYnOiBbJ2tvcmVhbicsICdhc2lhbiddLFxuICAn44K/44Kk5paZ55CGJzogWyd0aGFpJywgJ2FzaWFuJ10sXG4gICfjgqTjg7Pjg4nmlpnnkIYnOiBbJ2luZGlhbiddLFxuICAn44Ki44Oh44Oq44Kr44OzJzogWydhbWVyaWNhbicsICdidXJnZXInXSxcbiAgJ+eEvOiCiSc6IFsnYmJxJywgJ2tvcmVhbicsICd5YWtpbmlrdSddLFxuICAn5bGF6YWS5bGLJzogWydpemFrYXlhJywgJ2phcGFuZXNlJ10sXG4gICfjgqvjg5XjgqcnOiBbJ2NhZmUnLCAnY29mZmVlJ10sXG4gICfjg5XjgqHjgrnjg4jjg5Xjg7zjg4knOiBbJ2Zhc3RfZm9vZCcsICdidXJnZXInXSxcbiAgJ+a0i+mjnyc6IFsnd2VzdGVybicsICdldXJvcGVhbiddLFxuICAn44Ki44K444Ki5paZ55CGJzogWydhc2lhbicsICd0aGFpJywgJ3ZpZXRuYW1lc2UnLCAna29yZWFuJ10sXG4gICfjg5Djg7wnOiBbJ2JhcicsICdjb2NrdGFpbCddLFxuICAn5a+/5Y+4JzogWydzdXNoaScsICdqYXBhbmVzZSddLFxuICAn44Op44O844Oh44OzJzogWydyYW1lbicsICdqYXBhbmVzZSddLFxuICAn54S844GN6bOlJzogWyd5YWtpdG9yaScsICdqYXBhbmVzZSddLFxuICAn5aSp44G344KJJzogWyd0ZW1wdXJhJywgJ2phcGFuZXNlJ10sXG4gICfjgYbjganjgpMnOiBbJ3Vkb24nLCAnamFwYW5lc2UnXSxcbiAgJ+OBneOBsCc6IFsnc29iYScsICdqYXBhbmVzZSddLFxufTtcblxuLy8g6Led6Zui6KiI566X77yI44OP44OQ44K144Kk44Oz5YWs5byP77yJXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlRGlzdGFuY2UobGF0MTogbnVtYmVyLCBsb24xOiBudW1iZXIsIGxhdDI6IG51bWJlciwgbG9uMjogbnVtYmVyKTogbnVtYmVyIHtcbiAgY29uc3QgUiA9IDYzNzEwMDA7IC8vIOWcsOeQg+OBruWNiuW+hO+8iOODoeODvOODiOODq++8iVxuICBjb25zdCBkTGF0ID0gKGxhdDIgLSBsYXQxKSAqIE1hdGguUEkgLyAxODA7XG4gIGNvbnN0IGRMb24gPSAobG9uMiAtIGxvbjEpICogTWF0aC5QSSAvIDE4MDtcbiAgY29uc3QgYSA9IFxuICAgIE1hdGguc2luKGRMYXQvMikgKiBNYXRoLnNpbihkTGF0LzIpICtcbiAgICBNYXRoLmNvcyhsYXQxICogTWF0aC5QSSAvIDE4MCkgKiBNYXRoLmNvcyhsYXQyICogTWF0aC5QSSAvIDE4MCkgKiBcbiAgICBNYXRoLnNpbihkTG9uLzIpICogTWF0aC5zaW4oZExvbi8yKTtcbiAgY29uc3QgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEtYSkpO1xuICByZXR1cm4gUiAqIGM7XG59XG5cbi8vIE9TTeODh+ODvOOCv+OBi+OCieODrOOCueODiOODqeODs+aDheWgseOCkuaKveWHulxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlT1NNUmVzdGF1cmFudChlbGVtZW50OiBhbnksIHVzZXJMYXQ6IG51bWJlciwgdXNlckxvbjogbnVtYmVyKTogT1NNUmVzdGF1cmFudCB7XG4gIGNvbnN0IGxhdCA9IGVsZW1lbnQubGF0IHx8IChlbGVtZW50LmNlbnRlciA/IGVsZW1lbnQuY2VudGVyLmxhdCA6IDApO1xuICBjb25zdCBsb24gPSBlbGVtZW50LmxvbiB8fCAoZWxlbWVudC5jZW50ZXIgPyBlbGVtZW50LmNlbnRlci5sb24gOiAwKTtcbiAgXG4gIGNvbnN0IG5hbWUgPSBlbGVtZW50LnRhZ3M/Lm5hbWUgfHwgZWxlbWVudC50YWdzPy5bJ25hbWU6amEnXSB8fCAndW5rbm93bic7XG4gIGNvbnN0IGRpc3RhbmNlID0gY2FsY3VsYXRlRGlzdGFuY2UodXNlckxhdCwgdXNlckxvbiwgbGF0LCBsb24pO1xuXG4gIHJldHVybiB7XG4gICAgaWQ6IGAke2VsZW1lbnQudHlwZX1fJHtlbGVtZW50LmlkfWAsXG4gICAgbmFtZSxcbiAgICBjdWlzaW5lOiBlbGVtZW50LnRhZ3M/LmN1aXNpbmUsXG4gICAgYW1lbml0eTogZWxlbWVudC50YWdzPy5hbWVuaXR5LFxuICAgIGxhdCxcbiAgICBsb24sXG4gICAgdGFnczogZWxlbWVudC50YWdzIHx8IHt9LFxuICAgIGRpc3RhbmNlOiBNYXRoLnJvdW5kKGRpc3RhbmNlKSxcbiAgfTtcbn1cblxuLy8g5rCX5YiG44Gr5Z+644Gl44GP44K544Kz44Ki44Oq44Oz44KwXG5leHBvcnQgZnVuY3Rpb24gc2NvcmVSZXN0YXVyYW50KHJlc3RhdXJhbnQ6IE9TTVJlc3RhdXJhbnQsIG1vb2RBbmFseXNpczogYW55KTogbnVtYmVyIHtcbiAgbGV0IHNjb3JlID0gMTAwOyAvLyDjg5njg7zjgrnjgrnjgrPjgqJcblxuICAvLyDot53pm6LjgavjgojjgovmuJvngrnvvIjov5HjgYTjgbvjganpq5jlvpfngrnvvIlcbiAgaWYgKHJlc3RhdXJhbnQuZGlzdGFuY2UpIHtcbiAgICBzY29yZSAtPSBNYXRoLm1pbihyZXN0YXVyYW50LmRpc3RhbmNlIC8gNTAsIDUwKTsgLy8g5pyA5aSnNTDngrnmuJvngrlcbiAgfVxuXG4gIC8vIOaWmeeQhuOCv+OCpOODl+ODnuODg+ODgeODs+OCsFxuICBpZiAobW9vZEFuYWx5c2lzLmN1aXNpbmVfdHlwZXMgJiYgcmVzdGF1cmFudC5jdWlzaW5lKSB7XG4gICAgY29uc3QgbWF0Y2hlZEN1aXNpbmVzID0gbW9vZEFuYWx5c2lzLmN1aXNpbmVfdHlwZXMuc29tZSgodHlwZTogc3RyaW5nKSA9PiBcbiAgICAgIENVSVNJTkVfTUFQUElOR1t0eXBlXT8uc29tZShtYXBwZWRUeXBlID0+IFxuICAgICAgICByZXN0YXVyYW50LmN1aXNpbmU/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobWFwcGVkVHlwZSkgfHxcbiAgICAgICAgcmVzdGF1cmFudC50YWdzPy5jdWlzaW5lPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG1hcHBlZFR5cGUpXG4gICAgICApXG4gICAgKTtcbiAgICBpZiAobWF0Y2hlZEN1aXNpbmVzKSBzY29yZSArPSAzMDtcbiAgfVxuXG4gIC8vIOmbsOWbsuawl+ODnuODg+ODgeODs+OCsO+8iOOCv+OCsOODmeODvOOCue+8iVxuICBpZiAobW9vZEFuYWx5c2lzLmF0bW9zcGhlcmUpIHtcbiAgICBjb25zdCBhdG1vc3BoZXJlID0gbW9vZEFuYWx5c2lzLmF0bW9zcGhlcmUudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAoYXRtb3NwaGVyZS5pbmNsdWRlcygn44Oq44Op44OD44Kv44K5JykgJiYgKHJlc3RhdXJhbnQuYW1lbml0eSA9PT0gJ2NhZmUnIHx8IHJlc3RhdXJhbnQudGFncz8uYXRtb3NwaGVyZSA9PT0gJ2Nhc3VhbCcpKSB7XG4gICAgICBzY29yZSArPSAyMDtcbiAgICB9XG4gICAgaWYgKGF0bW9zcGhlcmUuaW5jbHVkZXMoJ+eJueWIpScpICYmIHJlc3RhdXJhbnQudGFncz8uZm9ybWFsID09PSAneWVzJykge1xuICAgICAgc2NvcmUgKz0gMjU7XG4gICAgfVxuICAgIGlmIChhdG1vc3BoZXJlLmluY2x1ZGVzKCfjgavjgY7jgoTjgYsnKSAmJiByZXN0YXVyYW50LmFtZW5pdHkgPT09ICdpemFrYXlhJykge1xuICAgICAgc2NvcmUgKz0gMjA7XG4gICAgfVxuICB9XG5cbiAgLy8g5L6h5qC85biv44Oe44OD44OB44Oz44KwXG4gIGlmIChtb29kQW5hbHlzaXMucHJpY2VfcmFuZ2UgJiYgcmVzdGF1cmFudC50YWdzPy5wcmljZV9yYW5nZSkge1xuICAgIGNvbnN0IHByaWNlTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG4gICAgICAn5a6J44GEJzogWyckJywgJ2J1ZGdldCcsICdjaGVhcCddLFxuICAgICAgJ+aZrumAmic6IFsnJCQnLCAnbW9kZXJhdGUnXSxcbiAgICAgICfpq5jjgYQnOiBbJyQkJCcsICckJCQkJywgJ2V4cGVuc2l2ZScsICdmaW5lX2RpbmluZyddXG4gICAgfTtcbiAgICBcbiAgICBjb25zdCBleHBlY3RlZFByaWNlcyA9IHByaWNlTWFwW21vb2RBbmFseXNpcy5wcmljZV9yYW5nZV0gfHwgW107XG4gICAgaWYgKGV4cGVjdGVkUHJpY2VzLnNvbWUocHJpY2UgPT4gcmVzdGF1cmFudC50YWdzPy5wcmljZV9yYW5nZT8uaW5jbHVkZXMocHJpY2UpKSkge1xuICAgICAgc2NvcmUgKz0gMTU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEwMCwgc2NvcmUpKTtcbn1cblxuLy8g44Oh44Kk44Oz5qSc57Si6Zai5pWwXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VhcmNoUmVzdGF1cmFudHMocGFyYW1zOiBTZWFyY2hQYXJhbXMsIG1vb2RBbmFseXNpcz86IGFueSk6IFByb21pc2U8T1NNUmVzdGF1cmFudFtdPiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ1NlYXJjaCBwYXJhbXM6JywgcGFyYW1zKTtcbiAgICBcbiAgICAvLyDmlpnnkIbjgr/jgqTjg5fjgpLoi7Hoqp4vT1NN44K/44Kw44Gr5aSJ5o+bXG4gICAgY29uc3QgY3Vpc2luZVR5cGVzID0gcGFyYW1zLmN1aXNpbmVUeXBlcz8uZmxhdE1hcCh0eXBlID0+IENVSVNJTkVfTUFQUElOR1t0eXBlXSB8fCBbXSkgfHwgW107XG4gICAgY29uc3Qgc2VhcmNoUGFyYW1zID0geyAuLi5wYXJhbXMsIGN1aXNpbmVUeXBlcyB9O1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdNYXBwZWQgY3Vpc2luZSB0eXBlczonLCBjdWlzaW5lVHlwZXMpO1xuXG4gICAgLy8gT3ZlcnBhc3Mg44Kv44Ko44Oq5a6f6KGMXG4gICAgY29uc3QgcXVlcnkgPSBidWlsZFJlc3RhdXJhbnRRdWVyeShzZWFyY2hQYXJhbXMpO1xuICAgIGNvbnNvbGUubG9nKCdPdmVycGFzcyBxdWVyeTonLCBxdWVyeS5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nKTtcbiAgICBcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcXVlcnlPdmVycGFzcyhxdWVyeSk7XG4gICAgY29uc29sZS5sb2coJ092ZXJwYXNzIHJlc3BvbnNlIGVsZW1lbnRzIGNvdW50OicsIGRhdGEuZWxlbWVudHM/Lmxlbmd0aCB8fCAwKTtcblxuICAgIGlmICghZGF0YS5lbGVtZW50cyB8fCBkYXRhLmVsZW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIC8vIOe1kOaenOOCkuino+aekFxuICAgIGNvbnN0IHJlc3RhdXJhbnRzOiBPU01SZXN0YXVyYW50W10gPSBkYXRhLmVsZW1lbnRzXG4gICAgICAuZmlsdGVyKChlbGVtZW50OiBhbnkpID0+IGVsZW1lbnQudGFncz8ubmFtZSkgLy8g5ZCN5YmN44GM44GC44KL44KC44Gu44Gu44G/XG4gICAgICAubWFwKChlbGVtZW50OiBhbnkpID0+IHBhcnNlT1NNUmVzdGF1cmFudChlbGVtZW50LCBwYXJhbXMubGF0LCBwYXJhbXMubG9uKSlcbiAgICAgIC5maWx0ZXIoKHJlc3RhdXJhbnQ6IE9TTVJlc3RhdXJhbnQpID0+IHJlc3RhdXJhbnQuZGlzdGFuY2UgJiYgcmVzdGF1cmFudC5kaXN0YW5jZSA8PSAocGFyYW1zLnJhZGl1cyB8fCAyMDAwKSk7XG5cbiAgICAvLyDmsJfliIbliIbmnpDjgavln7rjgaXjgY/jgrnjgrPjgqLjg6rjg7PjgrBcbiAgICBpZiAobW9vZEFuYWx5c2lzKSB7XG4gICAgICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xuICAgICAgICByZXN0YXVyYW50LnNjb3JlID0gc2NvcmVSZXN0YXVyYW50KHJlc3RhdXJhbnQsIG1vb2RBbmFseXNpcyk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8g44K544Kz44Ki6aCG44Gr44K944O844OIXG4gICAgICByZXN0YXVyYW50cy5zb3J0KChhLCBiKSA9PiAoYi5zY29yZSB8fCAwKSAtIChhLnNjb3JlIHx8IDApKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8g6Led6Zui6aCG44Gr44K944O844OIXG4gICAgICByZXN0YXVyYW50cy5zb3J0KChhLCBiKSA9PiAoYS5kaXN0YW5jZSB8fCAwKSAtIChiLmRpc3RhbmNlIHx8IDApKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdGF1cmFudHMuc2xpY2UoMCwgMjApOyAvLyDkuIrkvY0yMOS7tlxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1Jlc3RhdXJhbnQgc2VhcmNoIGVycm9yOicsIGVycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ+ODrOOCueODiOODqeODs+aknOe0ouOBq+WkseaVl+OBl+OBvuOBl+OBn+OAguODjeODg+ODiOODr+ODvOOCr+aOpee2muOCkueiuuiqjeOBl+OBpuOBj+OBoOOBleOBhOOAgicpO1xuICB9XG59XG5cbi8vIOS9j+aJgOOBi+OCieW6p+aomeOCkuWPluW+l++8iE5vbWluYXRpbSBBUEnvvIlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW9jb2RlQWRkcmVzcyhhZGRyZXNzOiBzdHJpbmcpOiBQcm9taXNlPHtsYXQ6IG51bWJlciwgbG9uOiBudW1iZXJ9IHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KCdodHRwczovL25vbWluYXRpbS5vcGVuc3RyZWV0bWFwLm9yZy9zZWFyY2gnLCB7XG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgcTogYWRkcmVzcyxcbiAgICAgICAgZm9ybWF0OiAnanNvbicsXG4gICAgICAgIGxpbWl0OiAxLFxuICAgICAgICBjb3VudHJ5Y29kZXM6ICdqcCcsIC8vIOaXpeacrOOBq+mZkOWumlxuICAgICAgfSxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ1VzZXItQWdlbnQnOiAnU2hpYnVNZXNoaS8xLjAgKGh0dHBzOi8vZ2l0aHViLmNvbS95b3VyLXJlcG8pJ1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHJlc3BvbnNlLmRhdGEgJiYgcmVzcG9uc2UuZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSByZXNwb25zZS5kYXRhWzBdO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbGF0OiBwYXJzZUZsb2F0KHJlc3VsdC5sYXQpLFxuICAgICAgICBsb246IHBhcnNlRmxvYXQocmVzdWx0LmxvbilcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignR2VvY29kaW5nIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufSAiXSwibmFtZXMiOlsiYXhpb3MiLCJPVkVSUEFTU19FTkRQT0lOVFMiLCJxdWVyeU92ZXJwYXNzIiwicXVlcnkiLCJsYXN0RXJyb3IiLCJlbmRwb2ludCIsInJlc3BvbnNlIiwicG9zdCIsImVuY29kZVVSSUNvbXBvbmVudCIsImhlYWRlcnMiLCJ0aW1lb3V0IiwiZGF0YSIsImVycm9yIiwiY29uc29sZSIsIndhcm4iLCJFcnJvciIsImJ1aWxkUmVzdGF1cmFudFF1ZXJ5IiwicGFyYW1zIiwibGF0IiwibG9uIiwicmFkaXVzIiwiY3Vpc2luZVR5cGVzIiwibGF0RGlmZiIsImxvbkRpZmYiLCJNYXRoIiwiY29zIiwiUEkiLCJzb3V0aCIsIm5vcnRoIiwid2VzdCIsImVhc3QiLCJjdWlzaW5lRmlsdGVyIiwibGVuZ3RoIiwiY3Vpc2luZVJlZ2V4IiwibWFwIiwidHlwZSIsInRvTG93ZXJDYXNlIiwiam9pbiIsInRyaW0iLCJDVUlTSU5FX01BUFBJTkciLCJjYWxjdWxhdGVEaXN0YW5jZSIsImxhdDEiLCJsb24xIiwibGF0MiIsImxvbjIiLCJSIiwiZExhdCIsImRMb24iLCJhIiwic2luIiwiYyIsImF0YW4yIiwic3FydCIsInBhcnNlT1NNUmVzdGF1cmFudCIsImVsZW1lbnQiLCJ1c2VyTGF0IiwidXNlckxvbiIsImNlbnRlciIsIm5hbWUiLCJ0YWdzIiwiZGlzdGFuY2UiLCJpZCIsImN1aXNpbmUiLCJhbWVuaXR5Iiwicm91bmQiLCJzY29yZVJlc3RhdXJhbnQiLCJyZXN0YXVyYW50IiwibW9vZEFuYWx5c2lzIiwic2NvcmUiLCJtaW4iLCJjdWlzaW5lX3R5cGVzIiwibWF0Y2hlZEN1aXNpbmVzIiwic29tZSIsIm1hcHBlZFR5cGUiLCJpbmNsdWRlcyIsImF0bW9zcGhlcmUiLCJmb3JtYWwiLCJwcmljZV9yYW5nZSIsInByaWNlTWFwIiwiZXhwZWN0ZWRQcmljZXMiLCJwcmljZSIsIm1heCIsInNlYXJjaFJlc3RhdXJhbnRzIiwibG9nIiwiZmxhdE1hcCIsInNlYXJjaFBhcmFtcyIsInN1YnN0cmluZyIsImVsZW1lbnRzIiwicmVzdGF1cmFudHMiLCJmaWx0ZXIiLCJmb3JFYWNoIiwic29ydCIsImIiLCJzbGljZSIsImdlb2NvZGVBZGRyZXNzIiwiYWRkcmVzcyIsImdldCIsInEiLCJmb3JtYXQiLCJsaW1pdCIsImNvdW50cnljb2RlcyIsInJlc3VsdCIsInBhcnNlRmxvYXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/overpass.ts\n");

/***/ }),

/***/ "(api)/./pages/api/search-restaurants-osm.ts":
/*!*********************************************!*\
  !*** ./pages/api/search-restaurants-osm.ts ***!
  \*********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_overpass__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/overpass */ \"(api)/./lib/overpass.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_overpass__WEBPACK_IMPORTED_MODULE_0__]);\n_lib_overpass__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const { location, moodAnalysis, radius = 2000 } = req.body;\n        // デバッグ用ログ\n        console.log(\"Search request body:\", JSON.stringify(req.body, null, 2));\n        if (!location) {\n            console.log(\"Location missing in request\");\n            return res.status(400).json({\n                error: \"位置情報が必要です\"\n            });\n        }\n        let lat, lon;\n        // 位置情報の処理\n        if (typeof location === \"string\") {\n            // 住所文字列の場合は座標に変換\n            const coords = await (0,_lib_overpass__WEBPACK_IMPORTED_MODULE_0__.geocodeAddress)(location);\n            if (!coords) {\n                return res.status(400).json({\n                    error: \"住所が見つかりませんでした\"\n                });\n            }\n            lat = coords.lat;\n            lon = coords.lon;\n        } else if (location.lat && (location.lon || location.lng)) {\n            // 座標が直接指定された場合（lng/lonの両方に対応）\n            lat = location.lat;\n            lon = location.lon || location.lng;\n        } else {\n            console.log(\"Invalid location format:\", location);\n            return res.status(400).json({\n                error: \"位置情報の形式が正しくありません\"\n            });\n        }\n        // 検索パラメータ\n        const searchParams = {\n            lat,\n            lon,\n            radius: parseInt(radius),\n            cuisineTypes: moodAnalysis?.cuisine_types || [],\n            atmosphere: moodAnalysis?.atmosphere,\n            priceRange: moodAnalysis?.price_range\n        };\n        // OpenStreetMapで店舗検索\n        const restaurants = await (0,_lib_overpass__WEBPACK_IMPORTED_MODULE_0__.searchRestaurants)(searchParams, moodAnalysis);\n        // 結果を返す\n        res.status(200).json({\n            success: true,\n            restaurants,\n            searchCenter: {\n                lat,\n                lon\n            },\n            searchRadius: radius,\n            totalFound: restaurants.length\n        });\n    } catch (error) {\n        console.error(\"Restaurant search error:\", error);\n        console.error(\"Error stack:\", error instanceof Error ? error.stack : \"No stack trace\");\n        const errorMessage = error instanceof Error ? error.message : \"レストラン検索に失敗しました\";\n        console.error(\"Sending error response:\", errorMessage);\n        res.status(500).json({\n            error: errorMessage,\n            success: false,\n            debug: {\n                errorType: error instanceof Error ? error.constructor.name : typeof error,\n                message: errorMessage\n            }\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvc2VhcmNoLXJlc3RhdXJhbnRzLW9zbS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUN1RTtBQUV4RCxlQUFlRSxRQUFRQyxHQUFtQixFQUFFQyxHQUFvQjtJQUM3RSxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUN6QixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBcUI7SUFDNUQ7SUFFQSxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxRQUFRLEVBQUVDLFlBQVksRUFBRUMsU0FBUyxJQUFJLEVBQUUsR0FBR1IsSUFBSVMsSUFBSTtRQUUxRCxVQUFVO1FBQ1ZDLFFBQVFDLEdBQUcsQ0FBQyx3QkFBd0JDLEtBQUtDLFNBQVMsQ0FBQ2IsSUFBSVMsSUFBSSxFQUFFLE1BQU07UUFFbkUsSUFBSSxDQUFDSCxVQUFVO1lBQ2JJLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU9WLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBWTtRQUNuRDtRQUVBLElBQUlTLEtBQWFDO1FBRWpCLFVBQVU7UUFDVixJQUFJLE9BQU9ULGFBQWEsVUFBVTtZQUNoQyxpQkFBaUI7WUFDakIsTUFBTVUsU0FBUyxNQUFNbEIsNkRBQWNBLENBQUNRO1lBQ3BDLElBQUksQ0FBQ1UsUUFBUTtnQkFDWCxPQUFPZixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUFFQyxPQUFPO2dCQUFnQjtZQUN2RDtZQUNBUyxNQUFNRSxPQUFPRixHQUFHO1lBQ2hCQyxNQUFNQyxPQUFPRCxHQUFHO1FBQ2xCLE9BQU8sSUFBSVQsU0FBU1EsR0FBRyxJQUFLUixDQUFBQSxTQUFTUyxHQUFHLElBQUlULFNBQVNXLEdBQUcsR0FBRztZQUN6RCw4QkFBOEI7WUFDOUJILE1BQU1SLFNBQVNRLEdBQUc7WUFDbEJDLE1BQU1ULFNBQVNTLEdBQUcsSUFBSVQsU0FBU1csR0FBRztRQUNwQyxPQUFPO1lBQ0xQLFFBQVFDLEdBQUcsQ0FBQyw0QkFBNEJMO1lBQ3hDLE9BQU9MLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBbUI7UUFDMUQ7UUFFQSxVQUFVO1FBQ1YsTUFBTWEsZUFBZTtZQUNuQko7WUFDQUM7WUFDQVAsUUFBUVcsU0FBU1g7WUFDakJZLGNBQWNiLGNBQWNjLGlCQUFpQixFQUFFO1lBQy9DQyxZQUFZZixjQUFjZTtZQUMxQkMsWUFBWWhCLGNBQWNpQjtRQUM1QjtRQUVBLHFCQUFxQjtRQUNyQixNQUFNQyxjQUFjLE1BQU01QixnRUFBaUJBLENBQUNxQixjQUFjWDtRQUUxRCxRQUFRO1FBQ1JOLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDbkJzQixTQUFTO1lBQ1REO1lBQ0FFLGNBQWM7Z0JBQUViO2dCQUFLQztZQUFJO1lBQ3pCYSxjQUFjcEI7WUFDZHFCLFlBQVlKLFlBQVlLLE1BQU07UUFDaEM7SUFFRixFQUFFLE9BQU96QixPQUFPO1FBQ2RLLFFBQVFMLEtBQUssQ0FBQyw0QkFBNEJBO1FBQzFDSyxRQUFRTCxLQUFLLENBQUMsZ0JBQWdCQSxpQkFBaUIwQixRQUFRMUIsTUFBTTJCLEtBQUssR0FBRztRQUVyRSxNQUFNQyxlQUFlNUIsaUJBQWlCMEIsUUFBUTFCLE1BQU02QixPQUFPLEdBQUc7UUFDOUR4QixRQUFRTCxLQUFLLENBQUMsMkJBQTJCNEI7UUFFekNoQyxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQ25CQyxPQUFPNEI7WUFDUFAsU0FBUztZQUNUUyxPQUFPO2dCQUNMQyxXQUFXL0IsaUJBQWlCMEIsUUFBUTFCLE1BQU1nQyxXQUFXLENBQUNDLElBQUksR0FBRyxPQUFPakM7Z0JBQ3BFNkIsU0FBU0Q7WUFDWDtRQUNGO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NoaWJ1LW1lc2hpLy4vcGFnZXMvYXBpL3NlYXJjaC1yZXN0YXVyYW50cy1vc20udHM/NTEyNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgeyBzZWFyY2hSZXN0YXVyYW50cywgZ2VvY29kZUFkZHJlc3MgfSBmcm9tICcuLi8uLi9saWIvb3ZlcnBhc3MnO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSAnUE9TVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgbG9jYXRpb24sIG1vb2RBbmFseXNpcywgcmFkaXVzID0gMjAwMCB9ID0gcmVxLmJvZHk7XG4gICAgXG4gICAgLy8g44OH44OQ44OD44Kw55So44Ot44KwXG4gICAgY29uc29sZS5sb2coJ1NlYXJjaCByZXF1ZXN0IGJvZHk6JywgSlNPTi5zdHJpbmdpZnkocmVxLmJvZHksIG51bGwsIDIpKTtcblxuICAgIGlmICghbG9jYXRpb24pIHtcbiAgICAgIGNvbnNvbGUubG9nKCdMb2NhdGlvbiBtaXNzaW5nIGluIHJlcXVlc3QnKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAn5L2N572u5oOF5aCx44GM5b+F6KaB44Gn44GZJyB9KTtcbiAgICB9XG5cbiAgICBsZXQgbGF0OiBudW1iZXIsIGxvbjogbnVtYmVyO1xuXG4gICAgLy8g5L2N572u5oOF5aCx44Gu5Yem55CGXG4gICAgaWYgKHR5cGVvZiBsb2NhdGlvbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgIC8vIOS9j+aJgOaWh+Wtl+WIl+OBruWgtOWQiOOBr+W6p+aomeOBq+WkieaPm1xuICAgICAgY29uc3QgY29vcmRzID0gYXdhaXQgZ2VvY29kZUFkZHJlc3MobG9jYXRpb24pO1xuICAgICAgaWYgKCFjb29yZHMpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICfkvY/miYDjgYzopovjgaTjgYvjgorjgb7jgZvjgpPjgafjgZfjgZ8nIH0pO1xuICAgICAgfVxuICAgICAgbGF0ID0gY29vcmRzLmxhdDtcbiAgICAgIGxvbiA9IGNvb3Jkcy5sb247XG4gICAgfSBlbHNlIGlmIChsb2NhdGlvbi5sYXQgJiYgKGxvY2F0aW9uLmxvbiB8fCBsb2NhdGlvbi5sbmcpKSB7XG4gICAgICAvLyDluqfmqJnjgYznm7TmjqXmjIflrprjgZXjgozjgZ/loLTlkIjvvIhsbmcvbG9u44Gu5Lih5pa544Gr5a++5b+c77yJXG4gICAgICBsYXQgPSBsb2NhdGlvbi5sYXQ7XG4gICAgICBsb24gPSBsb2NhdGlvbi5sb24gfHwgbG9jYXRpb24ubG5nO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygnSW52YWxpZCBsb2NhdGlvbiBmb3JtYXQ6JywgbG9jYXRpb24pO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICfkvY3nva7mg4XloLHjga7lvaLlvI/jgYzmraPjgZfjgY/jgYLjgorjgb7jgZvjgpMnIH0pO1xuICAgIH1cblxuICAgIC8vIOaknOe0ouODkeODqeODoeODvOOCv1xuICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IHtcbiAgICAgIGxhdCxcbiAgICAgIGxvbixcbiAgICAgIHJhZGl1czogcGFyc2VJbnQocmFkaXVzKSxcbiAgICAgIGN1aXNpbmVUeXBlczogbW9vZEFuYWx5c2lzPy5jdWlzaW5lX3R5cGVzIHx8IFtdLFxuICAgICAgYXRtb3NwaGVyZTogbW9vZEFuYWx5c2lzPy5hdG1vc3BoZXJlLFxuICAgICAgcHJpY2VSYW5nZTogbW9vZEFuYWx5c2lzPy5wcmljZV9yYW5nZSxcbiAgICB9O1xuXG4gICAgLy8gT3BlblN0cmVldE1hcOOBp+W6l+iIl+aknOe0olxuICAgIGNvbnN0IHJlc3RhdXJhbnRzID0gYXdhaXQgc2VhcmNoUmVzdGF1cmFudHMoc2VhcmNoUGFyYW1zLCBtb29kQW5hbHlzaXMpO1xuXG4gICAgLy8g57WQ5p6c44KS6L+U44GZXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHJlc3RhdXJhbnRzLFxuICAgICAgc2VhcmNoQ2VudGVyOiB7IGxhdCwgbG9uIH0sXG4gICAgICBzZWFyY2hSYWRpdXM6IHJhZGl1cyxcbiAgICAgIHRvdGFsRm91bmQ6IHJlc3RhdXJhbnRzLmxlbmd0aCxcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1Jlc3RhdXJhbnQgc2VhcmNoIGVycm9yOicsIGVycm9yKTtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzdGFjazonLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiAnTm8gc3RhY2sgdHJhY2UnKTtcbiAgICBcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfjg6zjgrnjg4jjg6njg7PmpJzntKLjgavlpLHmlZfjgZfjgb7jgZfjgZ8nO1xuICAgIGNvbnNvbGUuZXJyb3IoJ1NlbmRpbmcgZXJyb3IgcmVzcG9uc2U6JywgZXJyb3JNZXNzYWdlKTtcbiAgICBcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxuICAgICAgZXJyb3I6IGVycm9yTWVzc2FnZSxcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZGVidWc6IHtcbiAgICAgICAgZXJyb3JUeXBlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IuY29uc3RydWN0b3IubmFtZSA6IHR5cGVvZiBlcnJvcixcbiAgICAgICAgbWVzc2FnZTogZXJyb3JNZXNzYWdlXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0gIl0sIm5hbWVzIjpbInNlYXJjaFJlc3RhdXJhbnRzIiwiZ2VvY29kZUFkZHJlc3MiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwibG9jYXRpb24iLCJtb29kQW5hbHlzaXMiLCJyYWRpdXMiLCJib2R5IiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJsYXQiLCJsb24iLCJjb29yZHMiLCJsbmciLCJzZWFyY2hQYXJhbXMiLCJwYXJzZUludCIsImN1aXNpbmVUeXBlcyIsImN1aXNpbmVfdHlwZXMiLCJhdG1vc3BoZXJlIiwicHJpY2VSYW5nZSIsInByaWNlX3JhbmdlIiwicmVzdGF1cmFudHMiLCJzdWNjZXNzIiwic2VhcmNoQ2VudGVyIiwic2VhcmNoUmFkaXVzIiwidG90YWxGb3VuZCIsImxlbmd0aCIsIkVycm9yIiwic3RhY2siLCJlcnJvck1lc3NhZ2UiLCJtZXNzYWdlIiwiZGVidWciLCJlcnJvclR5cGUiLCJjb25zdHJ1Y3RvciIsIm5hbWUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/search-restaurants-osm.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsearch-restaurants-osm&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsearch-restaurants-osm.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();